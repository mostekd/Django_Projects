{% extends "base.html" %}

{% block content %}
<table id="users-table" border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>Imię</th>
      <th>Email</th>
      <th>Miasto</th>
      <th>Wiek</th>
    </tr>
  </thead>
  <tbody id="users-body">
    <!-- tutaj będą wpisane wiersze przez JS -->
  </tbody>
</table>

<script>
  async function loadUsers() {
    const response = await fetch('/users/api/submissions/');
    const data = await response.json();

    const tbody = document.getElementById('users-body');
    tbody.innerHTML = ''; // wyczyść

    data.forEach(user => {
      const row = document.createElement('tr');

      row.innerHTML = `
        <td>${user.name}</td>
        <td>${user.email}</td>
        <td>${user.city ? user.city.name : ''}</td>
        <td>${user.age}</td>
      `;
      tbody.appendChild(row);
    });
  }

  window.addEventListener('DOMContentLoaded', loadUsers);
</script>
{% endblock content %}
